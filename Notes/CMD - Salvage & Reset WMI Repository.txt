https://superuser.com/questions/1152280/get-net-powershell-cmdlets-failing-with-invalid-class

1. Open Command Prompt and run as admin

2. Disable and stop the WMI service

	sc config winmgmt start= disabled
	net stop winmgmt

3. Run the following commands

	Winmgmt /salvagerepository %windir%\System32\wbem
	Winmgmt /resetrepository %windir%\System32\wbem

4. Re-enable the WMI service and reboot

	sc config winmgmt start= auto


-------------------------------------------------------------------------------------------------------


If the problem remains, then try the following steps to rebuild the repository:

1. Open Command Prompt and run as admin

2. Disable and stop the WMI service

	sc config winmgmt start= disabled     (note that there is one space between '=' and 'disabled')
	net stop winmgmt

3. Rename the repository folder (located at %windir%\System32\wbem\repository) to repository.old

4. Re-enable the WMI service

	sc config winmgmt start= auto

5. Reboot the machine.

If the above doesn't work try chkdsk, sfc, and dism. Additionally you can try a Windows Repair Install.
