https://superuser.com/questions/1152280/get-net-powershell-cmdlets-failing-with-invalid-class

1. Disable and stop the WMI service

	sc config winmgmt start= disabled
	net stop winmgmt

2. Run the following commands

	Winmgmt /salvagerepository %windir%\System32\wbem
	Winmgmt /resetrepository %windir%\System32\wbem

3. Re-enable the WMI service and reboot

	sc config winmgmt start= auto


-------------------------------------------------------------------------------------------------------


If the problem remains, then try the following steps to rebuild the repository:

1. Disable and stop the WMI service

	sc config winmgmt start= disabled     (note that there is a blank between '=' and 'disabled')
	net stop winmgmt

2. Rename the repository folder (located at %windir%\System32\wbem\repository) to repository.old

3. Re-enable the WMI service

	sc config winmgmt start= auto

4. Reboot the machine.

If the above doesn't work try chkdsk, sfc, and dism. Additionally you can try a Windows Repair Install.
